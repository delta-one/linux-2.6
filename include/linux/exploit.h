#ifndef _LINUX_EXPLOIT_H
#define _LINUX_EXPLOIT_H

#ifdef CONFIG_EXPLOIT_DETECTION
extern void _exploit(const char *id);

#define exploit_on(cond, id) \
	do { \
		if (unlikely(cond)) \
			_exploit(id); \
	} while (0)

#else

#define exploit_on(cond, id) \
	do { \
	} while (0)

#endif

#define exploit(id) exploit_on(true, id)

#endif
